# Grafonnet

Jsonnet library for generating Grafana dashboard files.

This library depends on JSON Schemas generated by [Grok](https://github.com/grafana/grok),
these schemas are generated directly from the Grafana repository to ensure Grafonnet can
keep up with Grafana development.

Grafonnet is the spiritual successor of [grafonnet-lib](https://github.com/grafana/grafonnet-lib).
As grafonnet-lib was manually written, it had a hard time to keep up with Grafana
development, this resulted in it being under-maintained. Besides that, it also came with
a performance penalty in jsonnet as it used the builder pattern, although visually
appealing it becomes very slow for environments that need to manage many dashboards.

## Requirements

Grafonnet uses the [Jsonnet](https://jsonnet.org/) programming language, the library can
be installed with [jsonnet-bundler](https://github.com/jsonnet-bundler/jsonnet-bundler/).

## Install

```console
jb install github.com/grafana/grafonnet/gen/grafonnet-latest@main
```

## Usage

```jsonnet
// dashboard.jsonnet
local grafonnet = import 'github.com/grafana/grafonnet/gen/grafonnet-latest/main.libsonnet';

grafonnet.dashboard.new('My Dashboard')
```

```console
jsonnet -J vendor dashboard.jsonnet
```

## Development

`make generate` uses `generate.jsonnet` to create Jsonnet libraries for each version in
`gen/<version>/`, it also creates `gen/grafonnet-latest/` which refers to the newest
version. These Jsonnet libraries depend on the JSON Schemas from Grok and `grafonnet-base/`.

The `grafonnet-base` library provides the logic to convert JSON Schemas to a runtime
library and adds veneer on top. The veneer is a thin layer on top of the raw library to
improve the user experience.
